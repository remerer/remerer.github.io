---
layout: post
title: SQL Data Manipulation Language
image: 2023-06-26-SQL_DML/banner.png
date: 2023-06-26
tags: [SQL Query]
categories: DB
---

# SQL Data Manipulation Language

<br>

# 1. SQL 조작어
---   
조작어는 크게 4가지 SELECT(선택), INSERT(삽입), UPDATE(수정), DELETE(삭제)로 나뉜다.   
이 외에 자주사용되는 키워드들과 엮어 세부 카테고리로 나누었다.   
세부 키워드는 `    ` 와 같이 하이라이트 처리

## 2.1 SELECT
데이터의 선택   

{%highlight sql%}
SELECT *
FROM ALPHABET abc 
{%endhighlight%}   

필요한 내용들(컬럼 이름)을 선택하고, `SELECT`  
ALPHABET이라는 이름을 가진 테이블에서 불러온다는 의미`FROM ALPHABET`  
여기서, `*`는 전체 컬럼을 불러온다는 의미이므로,  
해당 질의어는 ALPHABET테이블 전체를 불러오게 된다.
abc는 ALPHABET테이블의 별칭으로 같은 의미를 가진다. 아래의 `AS`구문과 동일

### 2.1.1 ORDER BY

정렬기준을 선택할 수 있다.
**ASC**(순차정렬)과 **DESC**(역정렬)로 정렬할 수 있으며,  
정렬조건이 여러개라면 뒤의것부터 정렬한 뒤에 앞에것을 정렬한다.
다중정렬의 구분은 ```,(콤마)```로 한다.

{%highlight sql%}

> SELECT ANIMAL_ID, NAME, DATETIME  
> FROM ANIMAL_INS ORDER BY NAME ASC, DATETIME DESC
{%endhighlight%}

해당코드는 데이터를 DATETIME기준으로 정렬후에, 이름으로 정렬한다.  
(최종적으로는 이름으로 순차정렬. 이름이 같은 경우에만 날짜로 역정렬)

### 2.1.2 WHERE

기초수식을 조건으로 둘 수 있다.  
프로그래밍과 다르게 등치기호를 `=` 하나만 쓴다.
기초적인 대소비교 및 특정 값과의 비교가 가능하다.
다중조건은 ```AND```나 ```OR```로 묶어줘야 한다.

### 2.1.3 LIMIT

정렬갯수에 제한을 걸고싶을 때 사용
`LIMIT 10` 과 같이 사용하면 된다

### 2.1.4 AS & DISTINCT

**AS** : 컬럼명을 변경하고 싶을 때 사용.  
**DISTINCT** : 중복된 값을 제거하고 싶을 때.

{%highlight sql%}
SELECT COUNT(DISTINCT NAME) AS nameNum
FROM TABLE
{%endhighlight%}

중복된 ```NAME```을 제거한 개수를 nameNum 컬럼으로 제공

| count |
| :---: |
|  96   |

<br>

### 2.1.4 IFNULL   

해당 값이 NULL일때, 대체하여 입력할 값   
{%highlight sql%}
SELECT PT_NAME, PT_NO, GEND_CD, AGE, IFNULL(TLNO, 'NONE') AS TLNO
FROM PATIENT WHERE AGE <= 12 AND GEND_CD = "W" ORDER BY AGE DESC, PT_NAME ASC 
{%endhighlight%}

TLNO가 NULL일때, "NONE" 출력

*추가로, NULL값을 판단할때는 `=`가 아닌 IS를 사용해야 한다.

### 2.1.5 DATE_FORMAT

DATE_FORMAT(입력값, 출력형식 or 출력 TEXT)
출력형식은 "%Y-%M-%D", "%y/%m/%d", "%y년 %m월 %d일" 등으로 표기할 수 있다.   
해당 출력형식은 대소문자를 구분한다.   

### 2.2 JOIN
결합구문은 여러 테이블의 레코드를 조합하여, 하나로 표현할 수 있게 해준다.   
기본적으로 아래 네가지 결합을 규정한다.   
> INNER JOIN
> OUTER JOIN
> LEFT JOIN
> RIGHT JOIN

#### 2.2.1 CROSS JOIN   

교차조인은 곱집합을 반환한다.   
A 테이블의 각 행과 B 테이블의 각 행을 곱연산한 결과값을 반환한다.   
따라서, 결과 테이블의 행은 (A행 수*B행 수)가 된다.   

#### 2.2.2 INNER JOIN   

내부조인은 가장 흔한 결합방식으로, A와 B테이블에 일치하는 결과를 가진 것만 반환한다.   
{% highlight sql %}
SELECT *
FROM A INNER JOIN B
ON A.ID = B.ID;
{% endhighlight %}
A테이블의 ID와 B테이블의 ID가 일치하는 내용만 반환   
(일치하지 않으면 제외된다)   
> 테이블 1 INNER JOIN 테이블 2
> ON 일치조건(AND로 결합)
<br>
   
#### 2.2.3 OUTER JOIN

**LEFT JOIN & RIGHT JOIN**

왼쪽/오른쪽 조인은 외부조인의 종류로서, 해당하는 방향의 테이블을 최소 1번씩은 출력한다.   

**FULL OUTER JOIN**

완전 외부 조인은, 양측 테이블의 내용을 모두 최소 한번씩은 출력하게 하는 외부조인이다.   
모든 결과값을 반환하는 방식.(CROSS JOIN과는 다르다)   
일치하는 결과값이 없더라도, 해당 데이터는 NULL로 반환된다.   
결과 테이블의 행은, (A행 수 + B행 수 - 겹치는갯수)가 된다.

#### 2.2.4 GROUP BY

##### HAVING 조건문
HAVING은 SUM, COUNT등과 결합하여 GROUP된 집합에서 필터링 조건을 추가한다.

# 3. 내용 정리

1. [PostgreSQL 키워드](https://www.postgresql.kr/docs/10/sql-keywords-appendix.html)
2. [MySQL 키워드](https://dev.mysql.com/doc/refman/8.0/en/keywords.html)
3. [Oracle 키워드](https://docs.oracle.com/cd/A97630_01/appdev.920/a42525/apb.htm)